% ============================================
%  Article Class (This is a LaTeX2e document)
% ============================================
\documentclass[12pt]{scrartcl}
\usepackage[english]{babel}
\usepackage[round]{natbib}
\usepackage[T1]{fontenc}
\usepackage{color}

% ============================
%  Figures and relative paths
% ============================
\usepackage{graphicx}
\graphicspath{{figures/}}

% =======================
%  References to classes
% =======================
\usepackage[colorlinks=true]{hyperref}
% metabolism
\newcommand{\rbametabolism}{\hyperref[sec:rba_metabolism]{\textbf{RBAMetabolism}}}
\newcommand{\compartment}{\hyperref[sec:compartment]{\textbf{Compartment}}}
\newcommand{\species}{\hyperref[sec:species]{\textbf{Species}}}
\newcommand{\reaction}{\hyperref[sec:reaction]{\textbf{Reaction}}}
\newcommand{\speciesreference}{\hyperref[sec:species_reference]{\textbf{SpeciesReference}}}
% parameters
\newcommand{\rbaparameters}{\hyperref[sec:rba_parameters]{\textbf{RBAParameters}}}
\newcommand{\function}{\hyperref[sec:function]{\textbf{Function}}}
\newcommand{\parameter}{\hyperref[sec:parameter]{\textbf{Parameter}}}
\newcommand{\aggregate}{\hyperref[sec:aggregate]{\textbf{Aggregate}}}
\newcommand{\functionreference}{\hyperref[sec:function_reference]{\textbf{FunctionReference}}}
% density
\newcommand{\rbadensity}{\hyperref[sec:rba_density]{\textbf{RBADensity}}}
\newcommand{\targetdensity}{\hyperref[sec:target_density]{\textbf{TargetDensity}}}
\newcommand{\targetvalue}{\hyperref[sec:target_value]{\textbf{TargetValue}}}
% macromolecules
\newcommand{\rbamacromolecules}{\hyperref[sec:rba_macromolecules]{\textbf{RBAMacromolecules}}}
\newcommand{\component}{\hyperref[sec:component]{\textbf{Component}}}
\newcommand{\macromolecule}{\hyperref[sec:macromolecule]{\textbf{Macromolecule}}}
\newcommand{\componentreference}{\hyperref[sec:component_reference]{\textbf{ComponentReference}}}
% processes
\newcommand{\rbaprocesses}{\hyperref[sec:rba_processes]{\textbf{RBAProcesses}}}
\newcommand{\process}{\hyperref[sec:process]{\textbf{Process}}}
\newcommand{\machinery}{\hyperref[sec:machinery]{\textbf{Machinery}}}
\newcommand{\machinerycomposition}{\hyperref[sec:machinery_composition]{\textbf{MachineryComposition}}}
\newcommand{\processings}{\hyperref[sec:processings]{\textbf{Processings}}}
\newcommand{\processing}{\hyperref[sec:processing]{\textbf{Processing}}}
\newcommand{\processingmap}{\hyperref[sec:processing_map]{\textbf{ProcessingMap}}}
\newcommand{\constantprocessing}{\hyperref[sec:constant_processing]{\textbf{ConstantProcessing}}}
\newcommand{\componentprocessing}{\hyperref[sec:component_processing]{\textbf{ComponentProcessing}}}
% enzymes
\newcommand{\rbaenzymes}{\hyperref[sec:rba_enzymes]{\textbf{RBAEnzymes}}}
\newcommand{\enzyme}{\hyperref[sec:enzyme]{\textbf{Enzyme}}}
% targets
\newcommand{\rbatargets}{\hyperref[sec:rba_targets]{\textbf{RBATargets}}}
\newcommand{\targetspecies}{\hyperref[sec:target_species]{\textbf{TargetSpecies}}}
\newcommand{\targetreaction}{\hyperref[sec:target_reaction]{\textbf{TargetReaction}}}



% ==========
%  Document
% ==========
\begin{document}

\title{XML format for RBA models}
\author{BioSys group, INRA Jouy, France}
\date{\today}

\maketitle

\newpage

\tableofcontents

\newpage

\section{Introduction}

In this document we present the XML structures used to define a RBA model.
A complete RBA model is composed of the following files:
\begin{itemize}
  \item metabolism.xml
  (definition of compartments, metabolic species and metabolic reactions).
  \item parameters.xml
  (definition of user-defined functions).
  \item density.xml (definition of density constraints).
  \item proteins.xml (definition of proteins).
  \item rnas.xml (definition of RNAs).
  \item dna.xml (definition of DNA).
  \item enzymes.xml
  (definition of enzymatic machineries catalyzing metabolic reactions).
  \item processes.xml
  (definition of cell processes used to produce macromolecules).
  \item targets.xml
  (definition of  necessary to growth and maintenance).
\end{itemize}

A valid RBA model must contain all these files with these exact names in
the same directory to be recognized by the RBApy parser.
For every file, we present the nodes that compose the XML structure.
For every node, we show a class diagram that shows the node's attributes
and the children nodes that it may/must contain.
We provide a brief description about the relevance of the node
in the RBA model.


\section{Conventions}

\subsection{Naming conventions in XML and RBApy}

All XML elements described here can be accessed with the RBApy package.
For example, the XML element Reaction can be accessed through python objects
of class Reaction.
This mirrorring scheme (every XML element has a corresponding python class) is
inspired by the scheme used in SBML and libSBML.
However, as in libSBML, the naming conventions may differ between python and XML:

\begin{itemize}
  \item XML elements and python classes both follow \texttt{ThisConvention} (e.g. \texttt{SpeciesReference}).
  \item XML attributes follow \texttt{thisConvention} (e.g.\ \texttt{boundaryCondition}), while
    python attributes follow \texttt{this\_convention} (e.g.\ \texttt{boundary\_condition}).
  \item In XML, list elements follow the convention \texttt{listOfThings}
    when they are seen as an instance/subelement
    (e.g. \texttt{RBAMetabolism} contains one instance of \texttt{ListOfCompartments} called \texttt{listOfCompartments}).
    In python, the \texttt{listOf} prefix is dropped and lower case is used
    (e.g. \texttt{RBAMetabolism} contains one instance of \texttt{ListOfCompartments} called \texttt{compartments}).
\end{itemize}

Throughout this document, XML conventions are used.
Please keep in mind that the convention for attributes/instances is different when using the
python package.

\subsection{Boolean attributes}

A boolean attribute evaluates to true if it is \texttt{"1"}
or \texttt{"true"} (case does not matter).
In all other cases it evaluates to false.

\subsection{Variables for user-defined functions}

The default variable for functions is the growth rate.
It can also be explicitly defined as by the string \texttt{growth\_rate}.
Alternatively, a function can take as an input the \emph{external}
concentration of a metabolite (e.g. for transport functions).
A metabolite identifier is expected to look like \texttt{met\_c},
where \texttt{met} is the name of the metabolite
and \texttt{c} its compartment.
Note that in the current version of RBApy,
every time a function based on \texttt{met\_c} is evaluated,
the compartment suffix is ignored and the extracellular concentration of the metabolite is used
\emph{no matter where the transport takes place}.
Typically, glucose import rates from the periplasm to the cytosol
will be based on the concentration of extracellular glucose.

\input{xml_metabolism}
\input{xml_parameters}
\input{xml_density}
\input{xml_macromolecules}
\input{xml_processes}
\input{xml_enzymes}
\input{xml_targets}


\end{document}
% ----------------------------------------------------------------
